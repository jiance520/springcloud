<!DOCTYPE html>
<html>
<head>
    <!--<meta http-equiv="Content-Type" content="multipart/form-data;charset=utf-8" />-->
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="css/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="css/themes/icon.css">
    <script type="text/javascript" src="js/jquery-1.12.4.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/datagrid-detailview.js"></script>
    <script type="text/javascript">
    </script>
    <style type="text/css">
        *{
            /*border: 1px solid #444;*/
        }
    </style>
</head>
<body>

<div id="product_content">
    <div id="product-toolbar" style="padding:2px 0">
        <table cellpadding="0" cellspacing="0" style="width:100%">
            <tr>
                <td style="padding-left:2px">
                    <a href="javascript:void(0)" id="icon_product_add" class="easyui-linkbutton" data-options="iconCls:'icon-add',plain:true" onclick="product_add()">添加产品</a>
                    <a href="javascript:void(0)" id="icon-product-editor" class="easyui-linkbutton" data-options="iconCls:'icon-edit',plain:true" onclick="product_edit()">修改</a>
                    <a href="javascript:void(0)" id="icon-product-del" class="easyui-linkbutton" data-options="iconCls:'icon-remove',plain:true" onclick="products_del()">批量删除</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="product_show()">详情</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="product_outxlsx()">导出到excel</a>
                    <form id='form_product' name="form_product" class=easyui-form style="display: inline-block" method="post" action="out_productAction" enctype="multipart/form-data">
                        <input id="fileproduct" name="excelfile" class="easyui-filebox" data-options="buttonText:'导入excel', accept:'application/vnd.ms-excel' "/><!--限制上传的文件为excel-->
                    </form>
                    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="product_inxlsx()">提交</a>
                </td>
                <td style="text-align:right;padding-right:2px">
                    <input id="product_search" class="easyui-searchbox" data-options="prompt:'输入帐号名称或编号'" style="width:150px" onclick="submit_sellorderSearch()"/>
                    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="submit_sellorderSearch()">搜索</a>
                </td>
            </tr>
        </table>
    </div>
    <table id="product_dg" class="easyui-datagrid" title=""
           data-options="singleSelect:false,rownumbers:false,collapsible:true,url:'productAllAction',method:'post',cache:false"><!--主页要改路径-->
    </table>
    <div id="win_product_add" class="easyui-window" title="增加产品" style="padding:10px 60px 20px 60px;width:1200px;height:800px;" data-options="modal:true,closed:'true'"></div>
    <div id="win_product_edit" class="easyui-window" title="产品修改" style="padding:10px 60px 20px 60px;width:1200px;height:800px;" data-options="modal:true,closed:'true'"></div>
    <div id="win_product_show" class="easyui-window" title="产品详情" style="padding:10px 60px 20px 60px;width:1200px;height:800px;" data-options="modal:true,closed:'true'"></div>
    <div id="win_product_show2" class="easyui-window" title="产品详情" style="padding:10px 60px 20px 60px;width:1200px;height:800px;" data-options="modal:true,closed:'true'">
        <table cellpadding="5">
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="userid" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="username" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="password" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="cpasswd" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="jpasswd" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="pin" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="question1" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="question2" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="question3" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="email" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="answer1" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="answer2" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="answer3" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="permission" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="cardid" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="uname" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="paycard" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="alipay" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="weixin" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="weibo" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="sharecode" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="telphone" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="qq" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="credibility" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="likes" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="umoney" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="income" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="points" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="grade" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="achievement" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="marriage" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="major" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="qualifications" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="speciality" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="blood" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="constellation" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="shengxiao" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="sex" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="postcode" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="salary" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="phone" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="company" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="job" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="school" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="reference" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="canceled" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="regdate" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="birthday" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="carddate" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="address" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="conaddress" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="headImg" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="cardimg1" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="cardimg2" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="qrcodeurl" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="aes256" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="hobby" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="mapjson" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="note" style="color:red"></td></tr>
            <tr><td style="padding:10px 0 10px 0;" align="right">产品ID:</td><td class="uother1" style="color:red"></td></tr>
        </table>
        <div style="text-align:center;padding:5px">
            <button class="btn bg-primary navbar-btn" onclick="win_product_close('#win_product_show2')">返回</button>
        </div>
    </div>

    <script type="text/javascript">
        var ovalue;//保存当前模糊查询数据
        var osort;//排序的列,也可以使用sortable:true，在用户点击列头时，easyui自动把sort和order发送给url后台。
        var oorder;//排序方式
        $(document).ready(function () {
            $('#product_dg').datagrid({
                //真正的自动展开/收缩列的大小，以适应网格的宽度，防止水平滚动。
                fitColumns:true,
                //隔行变色
                striped:true,
                //是否显示行号
//        rownumbers:true,
//        工具栏在最下面
//        fit:true,
                //分页工具位置
                // pagePosition:'top',
                //显示用户详情
                view:detailview,
                detailFormatter: function(rowIndex, rowData){
                    // admin = undefined
                    // if(rowData.admin==0)admin='前台'
                    // else admin='后台'
                    var imgpath1 = rowData.ONEIMG;
                    var imgpath2 = rowData.TWOIMG;
                    var imgpath3 = rowData.THREEIMG;
                    if(imgpath1.substring(0,3)=='img'){
                        imgpath1 = ""+imgpath1;/*第一种图片路径 img/product*/
                    }
                    if(imgpath1.substring(0,4)=='/img'){
                        imgpath1 = ".."+imgpath1;;/*第二种图片路径 /img/product*/
                    }
                    if(imgpath2!=false&&imgpath2!=null){//判断是空值或没有值用==和||,判断非空用!和&&。
                        if(imgpath2.substring(0,3)=='img'){
                            imgpath2 = ""+imgpath2;
                        }
                        if(imgpath2.substring(0,4)=='/img'){
                            imgpath2 = ".."+imgpath2;;
                        }
                    }
                    else{
                        imgpath2 = "http://localhost:8083/img/product/none.png";/*第三种图片路径*/
                    }
                    if(imgpath3!=false&&imgpath3!=null){
                        if(imgpath3.substring(0,3)=='img'){
                            imgpath3 = ""+imgpath3;
                        }
                        if(imgpath3.substring(0,4)=='/img'){
                            imgpath3 = ".."+imgpath3;;
                        }
                    }
                    else{
                        imgpath3 = "http://localhost:8083/img/product/none.png"
                    }
                    var detailTable=
                        '<div style="display:flex;">'+
                        '<table style="flex:1;">' +
                        '<tr>' +
                        '<td style="text-align:right;">产品ID: </td>' +
                        '<td style="padding-left:6px;">'+rowData.PRODUCTID+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">报警数量: </td>' +
                        '<td style="padding-left:6px;">'+rowData.ALARMNUM+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">折扣: </td>' +
                        '<td style="padding-left:6px;">'+rowData.DISCOUNT+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">是否打折: </td>' +
                        '<td style="padding-left:6px;">'+rowData.ISDISCOUNT+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">处理器: </td>' +
                        '<td style="padding-left:6px;">'+rowData.CPU+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">光驱: </td>' +
                        '<td style="padding-left:6px;">'+rowData.DVD+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">特性: </td>' +
                        '<td style="padding-left:6px;">'+rowData.FEAT+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">硬盘: </td>' +
                        '<td style="padding-left:6px;">'+rowData.DISK+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">系统: </td>' +
                        '<td style="padding-left:6px;">'+rowData.OS+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">屏幕: </td>' +
                        '<td style="padding-left:6px;">'+rowData.SREEN+'</td>' +
                        '</tr>' +
                        '<tr>' +
                        '<td style="text-align:right;">颜色: </td>' +
                        '<td style="padding-left:6px;">'+rowData.COLOR+'</td>' +
                        '</tr>' +
                        '</table>'+
                        '<div style="flex:2;text-align:center;">'+
                        '<img src="'+imgpath1+'"style="height:300px;"/>'+
                        '</div>'+
                        '<div style="flex:2;text-align:center;">'+
                        '<img src="'+imgpath2+'"style="height:300px;"/>'+
                        '</div>'+
                        '<div style="flex:2;text-align:center;">'+
                        '<img src="'+imgpath3+'"style="height:300px;"/>'+
                        '</div>'+
                        '</div>';
                    return detailTable;
                },
                columns:[[
                    {field:'ck',checkbox:true},
                    {field:'PRODUCTNO',title:'帐号编号',width:150,align:'center',sortable:true},
                    {field:'PRODUCTNAME',title:'帐号名称',width:150,align:'center',editor:'text',sortable:true},
                    {field:'PRICE',title:'销售价',width:150,align:'center',editor:'numberbox',sortable:true},
                    {field:'GENREID',title:'类型',width:150,align:'center',sortable:true,
                        editor:{
                            type:"combobox",
                            options:{
                                url:'genreAllAction',
                                valueField: "genreid",
                                textField: "name",
                                editable: true
                            }
                        },
                        formatter:function (value,row,index) {
                            return row.GENRE;
                        }
                    },
                    {field:'PRODUCTNUM',title:'库存',width:150,align:'center',editor:'numberbox',sortable:true},
                    {field:'BRANDID',title:'品牌',width:150,align:'center',sortable:true,
                        editor:{
                            type:"combobox",
                            options:{
                                url:'brandAllAction',
                                valueField: "brandid",
                                textField: "name",
                                editable: true
                            }
                        },
                        formatter:function (value,row,index) {
                            return row.BRAND;
                        }
                    },
                    {field:'LOGDATE',title:'增加时间',width:150,align:'center',sortable:true,
                        formatter:function(value,row,index){//alert(value)是一长串数字，
                            var date = new Date(value);//var date = new Date("september 1,2013,14:58:12");
                            var creationDate1 = product_formatter(date);//用来显示，无时分秒
                            var creationDate2 = product_formatter2(date);//真实时间带时分秒
                            row.creationDate = creationDate2;//有时分秒
//                    row.creationDate = creationDate1;//无时分秒
                            return creationDate2;
                        }
                    },
                    {field:'SUPPLIERID',title:'供货商',width:80,align:'center',sortable:true,order:'asc',
                        editor:{
                            type:"combobox",
                            options:{
                                url:'supplierAllAction',
                                valueField: "ssid",
                                textField: "name",
                                editable: true
                            }
                        },
                        formatter:function (value,row,index) {
                            return row.SUP;
                        }
                    },
                    {field:'action',title:'操作',width:100,align:'center',
                        formatter:function(value,row,index){ // value ：当前值，row:行对象，index:行下标
//                            if (row.editing){ // row.editing 是否被编辑
//                                var s = '<a href="javascript:void(0)"  onclick="product_saverow('+index+')">保存</a> ';
//                                var c = '<a href="javascript:void(0)"  onclick="product_cancelrow('+index+')">取消</a>';
//                                return s+c;
//                            } else {
//                                var e = '<a href="javascript:void(0)"  onclick="product_editrow('+index+')">编辑</a> ';
//                                var d = '<a href="javascript:void(0)"  onclick="product_deleterow('+index+')">删除</a> ';
//                                var f = '<a href="javascript:void(0)"  onclick="product_showrow('+index+')">查看</a>';
//                                return e+d+f;
//                            }
                                var d = '<a href="javascript:void(0)"  onclick="product_deleterow('+index+')">删除</a> ';
                                var f = '<a href="javascript:void(0)"  onclick="product_showrow('+index+')">查看</a>';
                                return d+f;
                        }
                    }
                ]],
                onBeforeEdit:function(index,row){
                    row.editing = true;
                    //重新刷新行
                    $('#product_dg').datagrid('refreshRow', index);
                },
                onAfterEdit:function(index,row){
                    row.editing = false;
                    //重新刷新行
                    //$('#product_dg').datagrid('refreshRow', index);
                    //如果有时间字段，使用以下代码刷新。
                    var jstr = JSON.stringify(row);//对象转 json string
//            var sobj = JSON.parse(jstr); //json string 转 js对象
//            var dt = sobj.creationDate;
//            var dt2 = dt.split(" ")[0];
//            dt2 = dt2.split("/");
//            var times = dt2[2]+"-"+dt2[0]+"-"+dt2[1];//转换后的时间
//            sobj.creationDate = times ;
//            alert(jstr);
                    $.post('update_productAction',row,function(data){
                        $('#product_dg').datagrid('reload');
                    });
                },
                onCancelEdit:function(index,row){
                    row.editing = false;
                    $('#product_dg').datagrid('refreshRow', index);
                },
                onSortColumn:function(sort, order){
                    osort = sort;
                    oorder = order;
                },
                // sortName:'SUM',//排序的列,也可以使用sortable:true，在用户点击列头时，easyui自动把sort和order发送给url后台。
                // sortOrder:'asc',//排序方式
                pagination:true,
                pageSize:16,
                pageList:[8,16,18],
                toolbar:"#product-toolbar"
            });
            //设置分页控件
            var pager = $('#product_dg').datagrid('getPager');
            $(pager).pagination({
//        pageSize: 5,//每页显示的记录条数，默认为10
//        pageList: [5,10,15],//可以设置每页记录条数的列表
                beforePageText: '第',//页数文本框前显示的汉字
                afterPageText: '页    共 {pages} 页',
                displayMsg: '当前显示 {from} - {to} 条记录   共 {total} 条记录',
            });
        });
        //导出xls
        function product_outxlsx() {
            //这里不能用ajax请求，ajax请求无法弹出下载保存对话框(重点)，因为是异步！即使使用同步，也不能获取到下载响应！
            var rows =$("#product_dg").datagrid("getSelections");//返回被选中的行
            var arrid = [];
            if(rows!=false&&rows!=null){
                $.each(rows,function (index,row) {
                    arrid.push(row.PRODUCTID);
                });
            }
            window.location.href="out_productAction?ovalue="+ovalue+'&osort='+osort+"&oorder="+oorder+"&arrid="+arrid;
        }
        //导入xls
        function product_inxlsx() {
            var formData = new FormData($('#form_product')[0]);/*用于传值给jsp*/
            // var excel1 = document.form_product.excelfile;/*这是一个input元素*/
            var excel = document.form_product.excelfile.files[0];/*这是一个File对象*/
            // formData.append('newValue', "newValue");
            $("#form_product").form('submit', {
                type:'POST',
                // url: 'http://localhost:8083/hshop/upload',/*指定固定上传位置，但进不了后台*/
                url: 'in_productAction',
                data: {'newValue':"newValue"},
                cache: false,
                processData: false,//禁止jquery对DAta数据的处理,默认会处理，//禁止的原因是,FormData已经帮我们做了处理
                contentType: false,//禁止设置请求类型
                onSubmit:function () {
                    // if(confirm("是否提交")){
                    //     return true;
                    // }
                    // else {
                    //     return false;
                    // }
                },
                success: function (result) {
                    if(result!=null&&result!=false){
                        alert("导入成功");
                        $('#product_dg').datagrid('reload');
                    }
                }
            });
        }
        function product_editrow(index){
            // 开始编辑，发送命令
            $('#product_dg').datagrid('beginEdit', index);
        }
        function product_deleterow(index){
            $.messager.confirm('Confirm','是否删除当前行?',function(r){
                if (r){
                    // 得到所有行
                    var rows = $('#product_dg').datagrid('getRows');
//                alert(rows.length);
                    // 根据下标拿当前行的数据
                    var row = rows[index];
                    // 发送ajax
                    $.post('del_productAction',row,function(data){
//                    alert(data);
                        if(data!=false&&data!=null){
                            // 删除1行，发命令
                            $('#product_dg').datagrid('reload');
//                          $('#sellorder_dg').datagrid('deleteRow', index);//使用此命令，浏览器会报错，datagrid-detailview.js:71 Uncaught TypeError: Cannot read property '_expander' of undefined
                        }
                    });

                }
            });
        }
        function product_saverow(index){
            // 结束编辑
            $('#product_dg').datagrid('endEdit', index);
        }
        function product_cancelrow(index){
            $('#product_dg').datagrid('cancelEdit', index);
        }
        function product_formatter(date){
            var y = date.getFullYear();
            var m = date.getMonth()+1;
            var d = date.getDate();
            return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d);
        }
        function product_formatter2(date){
            var y = date.getFullYear();
            var m = date.getMonth()+1;
            var d = date.getDate();
            var h = date.getHours();
            var mi = date.getMinutes();
            var s = date.getSeconds();
            var sss = date.getMilliseconds();
            return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d)+' '+(h<10?('0'+h):h)+":"+(mi<10?('0'+mi):mi)+":"+(s<10?('0'+s):s)+'.'+sss;
        }
        <!--模糊查询-->
        function submit_sellorderSearch() {
            var searchvalue = $("#product_search").val();
            ovalue = searchvalue;
            $('#product_dg').datagrid('load', {
                searchvalue:searchvalue
            });
        }
        // //全选,以下可有可无
        // function myCheckAll() {
        //     $('#product_dg').datagrid('checkAll');//勾选当前页中的所有行。
        // }
        // function myUncheckAll(){
        //     $('#product_dg').datagrid('uncheckAll');//取消勾选当前页中的所有行。
        // }
        // //刷新
        // function myReload() {
        //     $('#product_dg').datagrid('reload');
        // }
        //    产品增加
        function product_add() {
            $("#win_product_add").load("product_add.html"+" #product_add",function (result) {
                $(result).find("script").appendTo($("#product_add"));
            });
            $("#win_product_add").window('open');
        }
        //        产品修改
        function product_edit() {
            var selectrow = $("#product_dg").datagrid("getSelected");
//            事件触发时调用以下函数打开窗口(由于是后加载，窗口大小不能自适应！)：
            if(selectrow!=false&&selectrow!=null){
                $('#win_product_edit').window({
                    title: '产品修改',
                    top:30,
                    closed: false,
                    cache: false,
                    content:'<iframe name="iframe_product_edit" src="productMapAction?productid='+selectrow.PRODUCTID+'" width="1200px" height="1500px" frameborder="0" scrolling="no"></iframe>'
//                  href: 'product_edit.jsp?productid='+selectrow.PRODUCTID,
                });
                $("#win_product_edit").window('open');

            }
            else {
                alert("请先选择一行")
            }
        }
        function products_del() {
            var rows = $("#product_dg").datagrid("getSelections");//保存选中的id,返回一个存放JSON对象的数组。
            if(rows!=false&&rows!=null){
                $.messager.confirm('Confirm','是否删除所选行?',function(r){
                    if (r){
                        var arr = [];
                        $.each(rows,function (index,row) {
                            arr.push(row.PRODUCTID);
                        });
                        $.post('del_productsAction',{arr:arr},function(data){/*尽量传少量的数据到后台,rows 是一个数组，*/
                            if(data!=false&&data!=null){
                                $('#product_dg').datagrid('reload');
                            }
                        },'json');
                    }
                });
            }
            else {
                alert("请先选择行");
            }
        }
        //      产品介绍
        function product_show() {
            var selectrow = $("#product_dg").datagrid("getSelected");
            if(selectrow!=false&&selectrow!=null){
                $('#win_product_show').window({
                    title: '产品详情',
                    top:30,
                    closed: false,
                    cache: false,
                    content:'<iframe name="iframe_product_show" src="product_show.jsp?productid='+selectrow.PRODUCTID+'" width="1200px" height="800px" frameborder="0" scrolling="no"></iframe>',
//                  href: 'product_edit.jsp?productid='+selectrow.PRODUCTID,
                  modal: false
                });
                $("#win_product_show").window('open');
            }
            else {
                alert("请先选择一行")
            }
        }
        function product_showrow(index) {
            var rows = $('#product_dg').datagrid('getRows');
            var row = rows[index];
            var id = row.productid;
            // alert(JSON.stringify(row));
            $('.productid').html(row.PRODUCTID);
            $('.alarmnum').html(row.ALARMNUM);
            $('.discount').html(row.DISCOUNT);
            $('.isdiscount').html(row.ISDISCOUNT);
            $('.oneimg').html(row.ONEIMG);
            $('.price').html(row.PRICE);
            $('.productnum').html(row.PRODUCTNUM);
            $('.productname').html(row.PRODUCTNAME);
            $('.productno').html(row.PRODUCTNO);
            $('.threeimg').html(row.THREEIMG);
            $('.twoimg').html(row.TWOIMG);
            $('.brandid').html(row.BRANDID);
            $('.cpuunitid').html(row.CPUUNITID);
            $('.dvdromid').html(row.DVDROMID);
            $('.featureid').html(row.FEATUREID);
            $('.genreid').html(row.GENREID);
            $('.graphicsid').html(row.GRAPHICSID);
            $('.harddiskid').html(row.HARDDISKID);
            $('.productosid').html(row.PRODUCTOSID);
            $('.romid').html(row.ROMID);
            $('.screenid').html(row.SCREENID);
            $('.productstyleid').html(row.PRODUCTSTYLEID);
            $('.productdesc').html(row.PRODUCTDESC);
            $('.supplierid').html(row.SUPPLIERID);
            $('.logdate').html(row.LOGDATE);

            $('#win_product_show2').window('open');
            $('#win_product_show2').css({"height":"auto"});
            //
            // $('#dialog_express_show').dialog('open');
            // $('#dialog_express_show').dialog('refresh', 'express/express_show.jsp');/*通过ajax读取窗口内容。*/
        }
        //   关闭弹窗
        function win_product_close(selectid){
            $(selectid).window('close');
        }//   关闭对话框
        function dialog_product_close(selectid){
            $(selectid).dialog('close');
        }
        $.parser.parse("#product_content");
    </script>
</div>
</body>
</html>
